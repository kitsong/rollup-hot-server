{"code":"import { __awaiter } from \"tslib\";\r\nimport { getRollupConfigPath, getServerConfigPath } from './getConfigPath';\r\nimport { build } from './build';\r\nimport { watch } from 'rollup';\r\nimport { loadConfigFile } from './loadConfigFile';\r\nimport { Server, ServerConfig } from './server';\r\nexport function run(command) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const { config, server } = command;\r\n        try {\r\n            const loadRollupConfigFile = require('rollup/loadConfigFile');\r\n            const configFile = yield getRollupConfigPath(config);\r\n            const { options, warnings } = yield loadRollupConfigFile(configFile);\r\n            const serverFile = yield getServerConfigPath(server);\r\n            const serverFileConfig = (yield loadConfigFile(serverFile));\r\n            try {\r\n                for (const inputOptions of options) {\r\n                    yield build(inputOptions);\r\n                }\r\n                const serverConfig = new ServerConfig(serverFileConfig);\r\n                if (serverConfig.watch) {\r\n                    watch(options);\r\n                }\r\n                const server = new Server(serverConfig);\r\n                yield server.listen();\r\n            }\r\n            catch (err) {\r\n                warnings.flush();\r\n                throw new Error(err);\r\n            }\r\n        }\r\n        catch (err) {\r\n            throw new Error(err);\r\n        }\r\n    });\r\n}\r\n","references":["/Users/songwenjie/Desktop/rollup-hot-server/src/cli/option.ts","/Users/songwenjie/Desktop/rollup-hot-server/src/run/getConfigPath.ts","/Users/songwenjie/Desktop/rollup-hot-server/src/run/build.ts","/Users/songwenjie/Desktop/rollup-hot-server/node_modules/rollup/dist/rollup.d.ts","/Users/songwenjie/Desktop/rollup-hot-server/src/run/loadConfigFile.ts","/Users/songwenjie/Desktop/rollup-hot-server/src/run/server.ts"]}
